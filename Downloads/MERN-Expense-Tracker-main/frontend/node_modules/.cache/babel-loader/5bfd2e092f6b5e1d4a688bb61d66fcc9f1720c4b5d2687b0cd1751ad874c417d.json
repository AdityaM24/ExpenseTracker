{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{APIUrl,handleError,handleSuccess}from'../utils';import{ToastContainer}from'react-toastify';import ExpenseTable from'./ExpenseTable';import ExpenseDetails from'./ExpenseDetails';import ExpenseForm from'./ExpenseForm';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function Home(){const[loggedInUser,setLoggedInUser]=useState('');const[expenses,setExpenses]=useState([]);const[incomeAmt,setIncomeAmt]=useState(0);const[expenseAmt,setExpenseAmt]=useState(0);const navigate=useNavigate();useEffect(()=>{setLoggedInUser(localStorage.getItem('loggedInUser'));},[]);const handleLogout=e=>{localStorage.removeItem('token');localStorage.removeItem('loggedInUser');handleSuccess('User Logged Out');setTimeout(()=>{navigate('/login');},1000);};useEffect(()=>{const amounts=expenses.map(item=>item.amount);const income=amounts.filter(item=>item>0).reduce((acc,item)=>acc+=item,0);const exp=amounts.filter(item=>item<0).reduce((acc,item)=>acc+=item,0)*-1;setIncomeAmt(income);setExpenseAmt(exp);},[expenses]);const deleteExpens=async id=>{try{const url=\"\".concat(APIUrl,\"/expenses/\").concat(id);const headers={headers:{'Authorization':localStorage.getItem('token')},method:\"DELETE\"};const response=await fetch(url,headers);if(response.status===403){localStorage.removeItem('token');navigate('/login');return;}const result=await response.json();handleSuccess(result===null||result===void 0?void 0:result.message);console.log('--result',result.data);setExpenses(result.data);}catch(err){handleError(err);}};const fetchExpenses=async()=>{try{const url=\"\".concat(APIUrl,\"/expenses\");const headers={headers:{'Authorization':localStorage.getItem('token')}};const response=await fetch(url,headers);if(response.status===403){localStorage.removeItem('token');navigate('/login');return;}const result=await response.json();console.log('--result',result.data);setExpenses(result.data);}catch(err){handleError(err);}};const addTransaction=async data=>{try{const url=\"\".concat(APIUrl,\"/expenses\");const headers={headers:{'Authorization':localStorage.getItem('token'),'Content-Type':'application/json'},method:\"POST\",body:JSON.stringify(data)};const response=await fetch(url,headers);if(response.status===403){localStorage.removeItem('token');navigate('/login');return;}const result=await response.json();handleSuccess(result===null||result===void 0?void 0:result.message);console.log('--result',result.data);setExpenses(result.data);}catch(err){handleError(err);}};useEffect(()=>{fetchExpenses();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-section\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome \",loggedInUser]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"})]}),/*#__PURE__*/_jsx(ExpenseDetails,{incomeAmt:incomeAmt,expenseAmt:expenseAmt}),/*#__PURE__*/_jsx(ExpenseForm,{addTransaction:addTransaction}),/*#__PURE__*/_jsx(ExpenseTable,{expenses:expenses,deleteExpens:deleteExpens}),/*#__PURE__*/_jsx(ToastContainer,{})]});}export default Home;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","APIUrl","handleError","handleSuccess","ToastContainer","ExpenseTable","ExpenseDetails","ExpenseForm","jsxs","_jsxs","jsx","_jsx","Home","loggedInUser","setLoggedInUser","expenses","setExpenses","incomeAmt","setIncomeAmt","expenseAmt","setExpenseAmt","navigate","localStorage","getItem","handleLogout","e","removeItem","setTimeout","amounts","map","item","amount","income","filter","reduce","acc","exp","deleteExpens","id","url","concat","headers","method","response","fetch","status","result","json","message","console","log","data","err","fetchExpenses","addTransaction","body","JSON","stringify","children","className","onClick"],"sources":["C:/Users/adity/Downloads/MERN-Expense-Tracker-main/frontend/src/pages/Home.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useNavigate } from 'react-router-dom';\nimport { APIUrl, handleError, handleSuccess } from '../utils';\nimport { ToastContainer } from 'react-toastify';\nimport ExpenseTable from './ExpenseTable';\nimport ExpenseDetails from './ExpenseDetails';\nimport ExpenseForm from './ExpenseForm';\n\nfunction Home() {\n    const [loggedInUser, setLoggedInUser] = useState('');\n    const [expenses, setExpenses] = useState([]);\n    const [incomeAmt, setIncomeAmt] = useState(0);\n    const [expenseAmt, setExpenseAmt] = useState(0);\n\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        setLoggedInUser(localStorage.getItem('loggedInUser'))\n    }, [])\n\n    const handleLogout = (e) => {\n        localStorage.removeItem('token');\n        localStorage.removeItem('loggedInUser');\n        handleSuccess('User Logged Out');\n        setTimeout(() => {\n            navigate('/login');\n        }, 1000)\n    }\n    useEffect(() => {\n        const amounts = expenses.map(item => item.amount);\n        const income = amounts.filter(item => item > 0)\n            .reduce((acc, item) => (acc += item), 0);\n        const exp = amounts.filter(item => item < 0)\n            .reduce((acc, item) => (acc += item), 0) * -1;\n        setIncomeAmt(income);\n        setExpenseAmt(exp);\n    }, [expenses])\n\n    const deleteExpens = async (id) => {\n        try {\n            const url = `${APIUrl}/expenses/${id}`;\n            const headers = {\n                headers: {\n                    'Authorization': localStorage.getItem('token')\n                },\n                method: \"DELETE\"\n            }\n            const response = await fetch(url, headers);\n            if (response.status === 403) {\n                localStorage.removeItem('token');\n                navigate('/login');\n                return\n            }\n            const result = await response.json();\n            handleSuccess(result?.message)\n            console.log('--result', result.data);\n            setExpenses(result.data);\n        } catch (err) {\n            handleError(err);\n        }\n    }\n\n    const fetchExpenses = async () => {\n        try {\n            const url = `${APIUrl}/expenses`;\n            const headers = {\n                headers: {\n                    'Authorization': localStorage.getItem('token')\n                }\n            }\n            const response = await fetch(url, headers);\n            if (response.status === 403) {\n                localStorage.removeItem('token');\n                navigate('/login');\n                return\n            }\n            const result = await response.json();\n            console.log('--result', result.data);\n            setExpenses(result.data);\n        } catch (err) {\n            handleError(err);\n        }\n    }\n\n\n\n    const addTransaction = async (data) => {\n        try {\n            const url = `${APIUrl}/expenses`;\n            const headers = {\n                headers: {\n                    'Authorization': localStorage.getItem('token'),\n                    'Content-Type': 'application/json'\n                },\n                method: \"POST\",\n                body: JSON.stringify(data)\n            }\n            const response = await fetch(url, headers);\n            if (response.status === 403) {\n                localStorage.removeItem('token');\n                navigate('/login');\n                return\n            }\n            const result = await response.json();\n            handleSuccess(result?.message)\n            console.log('--result', result.data);\n            setExpenses(result.data);\n        } catch (err) {\n            handleError(err);\n        }\n    }\n\n    useEffect(() => {\n        fetchExpenses()\n    }, [])\n\n    return (\n        <div>\n            <div className='user-section'>\n                <h1>Welcome {loggedInUser}</h1>\n                <button onClick={handleLogout}>Logout</button>\n            </div>\n            <ExpenseDetails\n                incomeAmt={incomeAmt}\n                expenseAmt={expenseAmt}\n            />\n\n            <ExpenseForm\n                addTransaction={addTransaction} />\n\n            <ExpenseTable\n                expenses={expenses}\n                deleteExpens={deleteExpens}\n            />\n            <ToastContainer />\n        </div>\n    )\n}\n\nexport default Home"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}